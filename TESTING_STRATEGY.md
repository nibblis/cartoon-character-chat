### Стратегия тестирования и анализ покрытия кода

Этот документ описывает наш подход к тестированию, включая выбор тест-кейсов и использование отчетов о покрытии кода для оценки качества тестов.

---

### 1. Выбор тест-кейсов

Для обеспечения надежности кода мы используем три основных типа тест-кейсов. На примере `AutoReplyViewModel`:

-   **Happy Path (Успешный сценарий):** Проверяем, что основной функционал работает, как ожидается.
    -   `timer ticks down correctly`: таймер отсчитывает все секунды от 5 до 0.
    -   `timer emits finished event when done`: по завершении таймера отправляется событие.

-   **Negative Cases (Негативные сценарии):** Проверяем, как система реагирует на некорректные, но возможные действия пользователя.
    -   `starting timer twice restarts it`: повторный запуск таймера должен перезапускать его, а не создавать второй таймер параллельно.

-   **Edge Cases (Граничные случаи):** Проверяем поведение системы на границах или в нетипичных условиях.
    -   `stopping timer that was not started does nothing`: попытка остановить таймер, который никогда не запускался, не должна приводить к сбою.

Такой подход позволяет нам быть уверенными не только в том, что код работает, но и в том, что он устойчив к ошибкам и неожиданному поведению.

---

### 2. Анализ покрытия кода (Code Coverage)

Мы используем инструмент **JaCoCo** для генерации отчетов о покрытии кода тестами. Это помогает нам понять, какие части кода были проверены нашими тестами, а какие — нет.

-   **Как запустить:** Выполнить команду `./gradlew :app:testDebugUnitTestCoverage`.
-   **Где найти отчет:** HTML-отчет доступен в `app/build/reports/jacoco/testDebugUnitTestCoverage/html/index.html`.

**Как интерпретировать отчет:**

Отчет показывает процент покрытия для каждого класса и метода. Зеленым цветом выделены строки, которые были выполнены во время тестов, а красным — те, которые не были.

-   **Цель — не 100%:** Погоня за 100% покрытием часто бессмысленна и дорога. Хорошей целью является **~80-85%** для критически важной бизнес-логики (ViewModel, UseCases, Repositories).
-   **Важность анализа:** Низкое покрытие (~30-40%) — это явный сигнал, что код недостаточно протестирован. Если вы видите, что целые `if/else` блоки или важные методы окрашены красным, значит, для них нужно дописать тесты.

**Пример для `AutoReplyViewModel`:**
После добавления `happy`, `negative` и `edge` кейсов, отчет JaCoCo покажет, что все строки в `AutoReplyViewModel` покрыты тестами (окрашены зеленым). Это дает нам высокую уверенность в надежности этого компонента.
